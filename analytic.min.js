var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,d=[];!(b=a.next()).done;)d.push(b.value);return d};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};var establishedAt=new Date($("#established_at").attr("content"));function siteEstablishedDays(){var a=new Date;a=new Date(a.getFullYear(),a.getMonth(),a.getDate());return Math.floor((a-establishedAt)/864E5+1)}
$("#established-at").countdown(establishedAt,{elapse:!0}).on("update.countdown",function(a){a.elapsed&&$(this).html(a.strftime('<div class="ui label"><i class="rocket icon"></i>\u5df2\u4e0a\u7ebf</div><div class="ui label">%D<div class="detail">\u5929</div></div><div class="ui label">%-H<div class="detail">\u5c0f\u65f6</div></div><div class="ui label">%-M<div class="detail">\u5206</div></div><div class="ui label">%-S<div class="detail">\u79d2</div></div>'))});
var countUpOptions={useEasing:!0,useGrouping:!0,separator:",",decimal:".",prefix:"",suffix:""},yesterdayVisitorsCountUp=new CountUp("yesterday-visitors-stat",0,0,0,2.5,countUpOptions),yesterdayVisitsCountUp=new CountUp("yesterday-visits-stat",0,0,0,2.5,countUpOptions),yesterdayActionsCountUp=new CountUp("yesterday-actions-stat",0,0,0,2.5,countUpOptions),totalActionsCountUp=new CountUp("total-actions",0,0,0,2.5,countUpOptions),liveVisitorsCountUp=new CountUp("live-visitors-stat",0,0,0,2.5,countUpOptions),
todayVisitorsCountUp=new CountUp("today-visitors-stat",0,0,0,2.5,countUpOptions),todayVisitsCountUp=new CountUp("today-visits-stat",0,0,0,2.5,countUpOptions),todayActionsCountUp=new CountUp("today-actions-stat",0,0,0,2.5,countUpOptions);$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getUniqueVisitors",idSite:analyticsAPI.id,period:"day",date:"yesterday",format:"JSON",token_auth:analyticsAPI.token},function(a){yesterdayVisitorsCountUp.update(a.value)});
$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getVisits",idSite:analyticsAPI.id,period:"day",date:"yesterday",format:"JSON",token_auth:analyticsAPI.token},function(a){yesterdayVisitsCountUp.update(a.value)});$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getActions",idSite:analyticsAPI.id,period:"day",date:"yesterday",format:"JSON",token_auth:analyticsAPI.token},function(a){yesterdayActionsCountUp.update(a.value)});
function updateVisit(){$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getActions",idSite:analyticsAPI.id,period:"range",date:"last"+siteEstablishedDays(),format:"JSON",token_auth:analyticsAPI.token},function(a){totalActionsCountUp.update(a.value)});$.getJSON(analyticsAPI.url,{module:"API",method:"Live.getCounters",idSite:analyticsAPI.id,lastMinutes:"30",format:"JSON",token_auth:analyticsAPI.token},function(a){liveVisitorsCountUp.update(a[0].visitors)});$.getJSON(analyticsAPI.url,{module:"API",
method:"VisitsSummary.getUniqueVisitors",idSite:analyticsAPI.id,period:"day",date:"today",format:"JSON",token_auth:analyticsAPI.token},function(a){todayVisitorsCountUp.update(a.value)});$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getVisits",idSite:analyticsAPI.id,period:"day",date:"today",format:"JSON",token_auth:analyticsAPI.token},function(a){todayVisitsCountUp.update(a.value)});$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getActions",idSite:analyticsAPI.id,
period:"day",date:"today",format:"JSON",token_auth:analyticsAPI.token},function(a){todayActionsCountUp.update(a.value)})}updateVisit();setInterval(function(){document.hidden||updateVisit()},6E4);var visitSummaryChart=echarts.init(document.getElementById("visit-summary"),"light");
visitSummaryChart.setOption({baseOption:{title:{text:"\u8bbf\u5ba2\u6570\u636e\u603b\u89c8\uff08\u8fc7\u53bb90\u5929\uff09",left:"center"},legend:{data:["\u8bbf\u5ba2\u6570","\u8bbf\u95ee\u6b21\u6570","\u6d4f\u89c8\u6b21\u6570"],right:"center",top:30},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},toolbox:{showTitle:!1,feature:{restore:{},magicType:{type:["bar","line"]},dataView:{readOnly:!0},saveAsImage:{excludeComponents:["toolbox","dataZoom"]}}},dataZoom:[{type:"slider",show:!0,realtime:!0,
xAxisIndex:[0],start:50,end:100}],xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{name:"\u8bbf\u5ba2\u6570",type:"bar",data:[],animationDelay:function(a){return 10*a}},{name:"\u8bbf\u95ee\u6b21\u6570",type:"bar",data:[],animationDelay:function(a){return 10*a+100}},{name:"\u6d4f\u89c8\u6b21\u6570",type:"bar",data:[],animationDelay:function(a){return 10*a+200}}],animationEasing:"elasticOut",animationDelayUpdate:function(a){return 5*a}},media:[{query:{maxWidth:767},option:{legend:{orient:"vertical"},
grid:{top:110,left:40,right:10},toolbox:{show:!1}}}]});visitSummaryChart.showLoading();
function updateVisitSummaryChart(){$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getUniqueVisitors",idSite:analyticsAPI.id,period:"day",date:"last90",format:"JSON",token_auth:analyticsAPI.token},function(a){var b=[],d=[],e;for(e in a)b.push(e),d.push(a[e]);visitSummaryChart.setOption({xAxis:{data:b},series:[{name:"\u8bbf\u5ba2\u6570",data:d}]})});$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getVisits",idSite:analyticsAPI.id,period:"day",date:"last90",format:"JSON",
token_auth:analyticsAPI.token},function(a){var b=[],d;for(d in a)b.push(a[d]);visitSummaryChart.setOption({series:[{name:"\u8bbf\u95ee\u6b21\u6570",data:b}]})});$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getActions",idSite:analyticsAPI.id,period:"day",date:"last90",format:"JSON",token_auth:analyticsAPI.token},function(a){var b=[],d;for(d in a)b.push(a[d]);visitSummaryChart.setOption({series:[{name:"\u6d4f\u89c8\u6b21\u6570",data:b}]})})}updateVisitSummaryChart();visitSummaryChart.hideLoading();
setInterval(function(){document.hidden||updateVisitSummaryChart()},6E4);var visitHourlyChart=echarts.init(document.getElementById("visit-hourly"),"light");
visitHourlyChart.setOption({baseOption:{title:{text:"\u8bbf\u5ba2\u6570\u636e\uff087\u00d724\u5c0f\u65f6\uff09",left:"center"},legend:{data:["\u8bbf\u5ba2\u6570","\u8bbf\u95ee\u6b21\u6570","\u6d4f\u89c8\u6b21\u6570"],selectedMode:"single",right:"center",top:30},tooltip:{position:"top",formatter:function(a){return a.value[1]+" "+a.value[0]+"<br>"+a.seriesName+": "+a.value[2]}},toolbox:{showTitle:!1,feature:{restore:{},saveAsImage:{excludeComponents:["toolbox"]}}},xAxis:{type:"category",data:"00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23".split(" "),
boundaryGap:!1,splitLine:{show:!0,lineStyle:{type:"dashed"}}},yAxis:{type:"category",data:[],splitLine:{show:!0},axisLine:{show:!1}},series:[{name:"\u8bbf\u5ba2\u6570",type:"scatter",data:[],animationDelay:function(a){return 10*a+100}},{name:"\u8bbf\u95ee\u6b21\u6570",type:"scatter",data:[],animationDelay:function(a){return 10*a+100}},{name:"\u6d4f\u89c8\u6b21\u6570",type:"scatter",data:[],animationDelay:function(a){return 10*a+100}}]},media:[{query:{maxWidth:767},option:{legend:{orient:"vertical"},
grid:{top:110,left:70,right:10},toolbox:{show:!1}}}]});visitHourlyChart.showLoading();function normalizeSymbolSize(a,b,d){if(0===a)return 0;if(d){d=20;var e=5}else d=40,e=10;var g=Math.max.apply(Math,$jscomp.arrayFromIterable(b.map(function(f){return f[2]})));b=Math.min.apply(Math,$jscomp.arrayFromIterable(b.map(function(f){return f[2]})));return g===b?(d-e)/2+e:(a-b)/(g-b)*(d-e)+e}
function updateVisitHourlyChart(){$.getJSON(analyticsAPI.url,{module:"API",method:"VisitTime.getVisitInformationPerServerTime",idSite:analyticsAPI.id,period:"day",date:"last7",format:"JSON",token_auth:analyticsAPI.token},function(a){var b=[],d=[],e=[],g=[],f;for(f in a){b.unshift(f);for(var h in a[f])d.push([a[f][h].label,f,a[f][h].nb_uniq_visitors]),e.push([a[f][h].label,f,a[f][h].nb_visits]),g.push([a[f][h].label,f,a[f][h].nb_actions])}visitHourlyChart.setOption({baseOption:{yAxis:{data:b},series:[{name:"\u8bbf\u5ba2\u6570",
data:d,symbolSize:function(c){return normalizeSymbolSize(c[2],d,!1)}},{name:"\u8bbf\u95ee\u6b21\u6570",data:e,symbolSize:function(c){return normalizeSymbolSize(c[2],e,!1)}},{name:"\u6d4f\u89c8\u6b21\u6570",data:g,symbolSize:function(c){return normalizeSymbolSize(c[2],g,!1)}}]},media:[{query:{maxWidth:767},option:{series:[{name:"\u8bbf\u5ba2\u6570",data:d,symbolSize:function(c){return normalizeSymbolSize(c[2],d,!0)}},{name:"\u8bbf\u95ee\u6b21\u6570",data:e,symbolSize:function(c){return normalizeSymbolSize(c[2],
e,!0)}},{name:"\u6d4f\u89c8\u6b21\u6570",data:g,symbolSize:function(c){return normalizeSymbolSize(c[2],g,!0)}}]}}]})})}updateVisitHourlyChart();visitHourlyChart.hideLoading();setInterval(function(){document.hidden||updateVisitHourlyChart()},6E4);var visitMapChart=echarts.init(document.getElementById("visit-map"),"light");
visitMapChart.setOption({baseOption:{title:{text:"\u672c\u6708\u8bbf\u5ba2\u6765\u6e90",left:"center"},legend:{data:["\u8bbf\u5ba2\u6570","\u8bbf\u95ee\u6b21\u6570","\u6d4f\u89c8\u6b21\u6570"],selectedMode:"single",right:"center",top:30},tooltip:{trigger:"item",formatter:function(a){var b=a.value;b||(b=0);return a.seriesName+": "+b}},toolbox:{showTitle:!1,feature:{restore:{},saveAsImage:{excludeComponents:["toolbox"]}}},visualMap:{min:0,max:5E3,text:["High","Low"],calculable:!0},series:[{name:"\u8bbf\u5ba2\u6570",
type:"map",mapType:"world",showLegendSymbol:!1,itemStyle:{emphasis:{label:{show:!0}}},data:[]},{name:"\u8bbf\u95ee\u6b21\u6570",type:"map",mapType:"world",showLegendSymbol:!1,itemStyle:{emphasis:{label:{show:!0}}},data:[]},{name:"\u6d4f\u89c8\u6b21\u6570",type:"map",mapType:"world",showLegendSymbol:!1,itemStyle:{emphasis:{label:{show:!0}}},data:[]}]},media:[{query:{maxWidth:767},option:{legend:{orient:"vertical"},toolbox:{show:!1}}}]});
function updateVisitMapChart(){$.getJSON(analyticsAPI.url,{module:"API",method:"UserCountry.getCountry",idSite:analyticsAPI.id,period:"month",date:"today",format:"JSON",token_auth:analyticsAPI.token},function(a){var b=[],d=[],e=[],g=0,f=0,h=0,c;for(c in a)"China"==a[c].label?(g+=a[c].sum_daily_nb_uniq_visitors,f+=a[c].nb_visits,h+=a[c].nb_actions):"Hong Kong SAR China"==a[c].label?(g+=a[c].sum_daily_nb_uniq_visitors,f+=a[c].nb_visits,h+=a[c].nb_actions):"Taiwan"==a[c].label?(g+=a[c].sum_daily_nb_uniq_visitors,
f+=a[c].nb_visits,h+=a[c].nb_actions):"Unknown"==a[c].label?(g+=a[c].sum_daily_nb_uniq_visitors,f+=a[c].nb_visits,h+=a[c].nb_actions):(b.push({name:a[c].label,value:a[c].sum_daily_nb_uniq_visitors}),d.push({name:a[c].label,value:a[c].nb_visits}),e.push({name:a[c].label,value:a[c].nb_actions}));b.push({name:"China",value:g});d.push({name:"China",value:f});e.push({name:"China",value:h});visitMapChart.setOption({series:[{name:"\u8bbf\u5ba2\u6570",data:b},{name:"\u8bbf\u95ee\u6b21\u6570",data:d},{name:"\u6d4f\u89c8\u6b21\u6570",
data:e}]})})}updateVisitMapChart();setInterval(function(){document.hidden||updateVisitMapChart()},6E4);var visitCalendarChart=echarts.init(document.getElementById("visit-calendar"),"light"),firstYear=establishedAt.getFullYear(),maxYear=2021;
visitCalendarChart.setOption({baseOption:{title:{text:"\u5386\u5e74\u6d4f\u89c8\u6570\u636e",left:"center"},tooltip:{position:"top",formatter:function(a){return echarts.format.formatTime("yyyy-MM-dd",a.data[0])+" \u6d4f\u89c8\u6b21\u6570\uff1a"+a.data[1]}},toolbox:{showTitle:!1,feature:{restore:{},saveAsImage:{excludeComponents:["toolbox"]}}},visualMap:{min:50,max:1E3,calculable:!0,orient:"horizontal",top:"top",left:0},calendar:[{range:2016,right:5},{range:2017,right:5,top:240},{range:2018,right:5,
top:420},{range:2019,right:5,top:600},{range:2020,right:5,top:780},{range:2021,right:5,top:960}],series:[{type:"heatmap",coordinateSystem:"calendar",calendarIndex:0,data:[]},{type:"heatmap",coordinateSystem:"calendar",calendarIndex:1,data:[]},{type:"heatmap",coordinateSystem:"calendar",calendarIndex:2,data:[]},{type:"heatmap",coordinateSystem:"calendar",calendarIndex:3,data:[]},{type:"heatmap",coordinateSystem:"calendar",calendarIndex:4,data:[]},{type:"heatmap",coordinateSystem:"calendar",calendarIndex:5,
data:[]}]},media:[{query:{maxWidth:767},option:{toolbox:{show:!1},visualMap:{orient:"vertical"},calendar:[{orient:"vertical",left:"center",top:90},{orient:"vertical",left:"center",top:1220},{orient:"vertical",left:"center",top:2350},{orient:"vertical",left:"center",top:3480},{orient:"vertical",left:"center",top:4610},{orient:"vertical",left:"center",top:5740}]}}]});
function updateVisitCalendarChart(){$.getJSON(analyticsAPI.url,{module:"API",method:"VisitsSummary.getActions",idSite:analyticsAPI.id,period:"day",date:"last"+siteEstablishedDays(),format:"JSON",token_auth:analyticsAPI.token},function(a){var b=firstYear,d=[{calendarIndex:b-firstYear,data:[]}],e;for(e in a)if(0!==a[e]){year=Number(e.slice(0,4));if(year>b&&year<=maxYear)b=year,d.push({calendarIndex:b-firstYear,data:[]});else if(year<firstYear||year>maxYear)continue;d.forEach(function(g,f){g.calendarIndex==
b-firstYear&&d[f].data.push([echarts.format.formatTime("yyyy-MM-dd",e),a[e]])})}visitCalendarChart.setOption({series:d})})}updateVisitCalendarChart();setInterval(function(){document.hidden||updateVisitCalendarChart()},6E4);
